(function(r,m,u){"use strict";const l=/https:\/\/cdn.discordapp.com\/emojis\/(\d+).webp\?size=\d+/,g=u.before("updateRows",m.ReactNative.NativeModules.DCDChatManager,([y,x,b])=>{const p=JSON.parse(x);for(const c of p)if(console.log(c),c.message&&c.changeType!==3){const{content:n,embeds:i}=c.message;if(!n)continue;const a=n.findLastIndex(t=>t.type==="text"&&t.content!==`
`);if(a===-1||a===n.length-1)continue;const s=n.splice(a+1).filter(t=>t.type!=="text"||t.content!==`
`);if(s.some(t=>t.type!=="link"))continue;const N=s.map(t=>l.exec(t.target)).filter(Boolean).map(([,t])=>[t,`https://cdn.discordapp.com/emojis/${t}.webp?size=160`]),j=s.filter(t=>l.test(t.target));n.push(...j);const v=s.map(t=>t.target);for(let t=0;t<n.length;t++){const e=n[t];if(e.type!=="text")continue;const f=N.shift();if(!f)break;let o=e.content.indexOf("  ");if(o===-1&&(o=e.content.lastIndexOf(`
`)),o===-1)continue;const[w,d]=f,O=e.content.slice(0,o),z=e.content.slice(o);e.content=(t!==0?" ":"")+O.trim()+" ",n.splice(t+1,0,{type:"customEmoji",id:w,alt:"<realmoji>",src:d,frozenSrc:d},{type:"text",content:" "+z.trim()})}for(let t=0;t<i.length;t++){const e=i[t];e.type==="image"&&v.includes(e.url)&&i.splice(t--,1)}}return[y,JSON.stringify(p),b]}),h=()=>g();return r.onUnload=h,r})({},vendetta.metro.common,vendetta.patcher);
