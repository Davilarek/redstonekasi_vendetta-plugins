(function(p,f,m){"use strict";const u=/https:\/\/cdn.discordapp.com\/emojis\/(\d+).webp\?size=\d+/,g=m.before("updateRows",f.ReactNative.NativeModules.DCDChatManager,([y,x,b])=>{const d=JSON.parse(x);for(const c of d)if(console.log(c),c.message&&c.changeType!==3){const{content:n,embeds:s}=c.message;if(!n)continue;const i=n.findLastIndex(t=>t.type==="text"&&t.content!==`
`);if(i===-1||i===n.length-1)continue;const a=n.splice(i+1).filter(t=>t.type!=="text"||t.content!==`
`);if(a.some(t=>t.type!=="link"))continue;const j=a.map(t=>t.target);for(let t=0;t<n.length;t++){const e=n[t];if(e.type!=="text")continue;const l=a.shift();if(!l)break;let o=e.content.indexOf("  ");if(o===-1&&(o=e.content.lastIndexOf(`
`)),o===-1)continue;const[N,r]=u.exec(l.target);if(!N)continue;const v=e.content.slice(0,o),w=e.content.slice(o);e.content=(t!==0?" ":"")+v.trim()+" ",n.splice(t+1,0,{type:"customEmoji",id:r,alt:"<realmoji>",src:`https://cdn.discordapp.com/emojis/${r}.webp?size=160`,frozenSrc:`https://cdn.discordapp.com/emojis/${r}.webp?size=160`},{type:"text",content:" "+w.trim()})}for(let t=0;t<s.length;t++){const e=s[t];e.type==="image"&&j.includes(e.url)&&s.splice(t--,1)}}return[y,JSON.stringify(d),b]}),h=()=>g();return p.onUnload=h,p})({},vendetta.metro.common,vendetta.patcher);
